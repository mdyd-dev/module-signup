---
name: reset_password
resource: User
resource_owner: anyone
flash_notice: 'Your password has been changed!'
redirect_to: /password-changed
configuration:
  email:
    property_options:
      readonly: true
  password:
    validation:
      presence:
        message: 'You need to enter your password'
      length:
        minimum: 8
        message: 'Password is too short, required minimum is 8 characters'
authorization_policies:
  - token_is_valid
  - not_logged_in
---
{% form html-novalidate: '', html-class: 'with-action-bar' %}
  <input name="token" value="{{ params.token }}" type="hidden">
  <input name="email" value="{{ form.email }}" type="hidden">

  {%-
    include 'shared/forms/fields/text',
      name: 'password',
      type: 'password',
      label: 'Set new password',
      container_attrs: 'data-field-password',
      autocomplete: 'new-password',
      fieldClass: 'has-password-strength',
      id: 'form-password',
      required: true,
      minor_hint: 'Use at least 8 characters. To increase the password strength, use at least 1 digit or special character.',
      custom_html: '<span class="form-password-reveal form-field-addon is-bottom" data-password-reveal data-state="password"><span data-password-reveal-label>Show</span> password</span>'
  -%}

  {%- include 'shared/forms/form_submit', label: 'Reset password' -%}
{% endform %}
